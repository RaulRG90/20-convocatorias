{"version":3,"file":"mdb-file-upload.js","sources":["../../../projects/mdb-file-upload/src/lib/file-upload/file-upload.component.ts","../../../projects/mdb-file-upload/src/lib/mdb-file-upload.module.ts","../../../projects/mdb-file-upload/src/public_api.ts","../../../projects/mdb-file-upload/src/mdb-file-upload.ts"],"sourcesContent":["import {\n  Component,\n  ViewChild,\n  ElementRef,\n  Input,\n  Output,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n} from '@angular/core';\nimport { faCloudUploadAlt, faFile, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FaIconLibrary } from '@fortawesome/angular-fontawesome';\n\nexport interface ITextTranslation {\n  fileText?: string;\n  removeText?: string;\n  imageFileText?: string;\n}\n\n@Component({\n  selector: 'mdb-file-upload',\n  templateUrl: './file-upload.component.html',\n  styleUrls: ['./file-upload.component.scss'],\n})\nexport class MdbFileUploadComponent implements OnChanges {\n  @ViewChild('fileInput', { static: true }) fileInput: ElementRef;\n\n  @Input() disabled = false;\n  @Input() height = 200;\n  @Input()\n  get defaultFile() {\n    return this._defaultFile;\n  }\n  set defaultFile(value: string) {\n    if (value) {\n      this._defaultFile = value;\n      this._setDefaultPreview(value);\n    }\n  }\n  private _defaultFile: string;\n  @Input() customText: ITextTranslation;\n\n  textTranslation: ITextTranslation = {\n    fileText: 'Drag and drop a file here or click',\n    removeText: 'Remove',\n    imageFileText: 'Drag and drop or click to replace',\n  };\n\n  @Output() fileAdded = new EventEmitter<File>();\n  @Output() fileRemoved = new EventEmitter<any>();\n\n  imageFileExtensions: string[] = ['png', 'jpg', 'jpeg', 'bmp', 'gif'];\n  url: string | ArrayBuffer;\n  fileType: string;\n  fileName: string;\n  dragging: boolean;\n  isFileAdded = false;\n  isImageFile = false;\n  defaultPreview = false;\n\n  constructor(library: FaIconLibrary) {\n    library.addIcons(faCloudUploadAlt, faFile, faTrashAlt);\n  }\n\n  private _setDefaultPreview(url: string) {\n    this.url = url;\n    this.fileName = this._cleanFileName(url);\n    this.defaultPreview = true;\n\n    if (this.isImage(this.fileName)) {\n      this.isImageFile = true;\n    } else {\n      this.isImageFile = false;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['customText']) {\n      const currentValue = changes['customText'].currentValue;\n\n      Object.keys(currentValue).forEach((k) => {\n        this.textTranslation[k] = currentValue[k];\n      });\n    }\n  }\n\n  onFilesAdded() {\n    if (!this.dragging && !this.disabled) {\n      const file: File = this.fileInput.nativeElement.files[0];\n      if (file) {\n        this.fileType = this.getFileType(file.name);\n        this.fileName = file.name;\n        this.isFileAdded = true;\n\n        this.showPreview(file);\n\n        this.fileAdded.emit(file);\n      }\n    }\n  }\n\n  onFileDrop(event: any) {\n    if (event.dataTransfer && this.dragging && !this.disabled) {\n      event.dataTransfer.dropEffect = 'copy';\n      const file: File = event.dataTransfer.files[0];\n      this.fileType = this.getFileType(file.name);\n      this.fileName = file.name;\n      this.showPreview(file);\n    }\n    this.dragging = false;\n  }\n\n  onDragOver(event: any) {\n    if (!this.disabled) {\n      this.dragging = true;\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  onDragLeave(event: any) {\n    if (!this.disabled) {\n      this.dragging = false;\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n\n  reset() {\n    if (this.isFileAdded) {\n      this.removePreview();\n      this.fileInput.nativeElement.value = '';\n      this.fileRemoved.emit();\n    }\n\n    if (this.defaultPreview) {\n      this.fileInput.nativeElement.value = '';\n      this.defaultPreview = false;\n    }\n  }\n\n  showPreview(file: any) {\n    if (this.isImage(file.name)) {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = () => {\n        this.url = reader.result;\n      };\n      this.isImageFile = true;\n    } else {\n      this.isImageFile = false;\n    }\n\n    if (this.defaultPreview) {\n      this.defaultPreview = false;\n    }\n  }\n\n  removePreview() {\n    this.isFileAdded = false;\n  }\n\n  getFileType(fileName: string): string {\n    return fileName.split('.').pop().toLowerCase();\n  }\n\n  isImage(fileName: string) {\n    return this.imageFileExtensions.indexOf(this.getFileType(fileName)) !== -1;\n  }\n\n  private _cleanFileName(url: string): string {\n    return url.split('/').pop();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { MdbFileUploadComponent } from './file-upload/file-upload.component';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  declarations: [MdbFileUploadComponent],\n  imports: [\n    CommonModule,\n    FontAwesomeModule\n  ],\n  exports: [MdbFileUploadComponent]\n})\nexport class MdbFileUploadModule {}\n","/*\n * Public API Surface of mdb-file-upload\n */\n\nexport * from './lib/mdb-file-upload.module';\nexport * from './lib/file-upload/file-upload.component';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}
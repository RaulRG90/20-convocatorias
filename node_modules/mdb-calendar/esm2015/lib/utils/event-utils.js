import { format } from 'date-fns';
export const MS_IN_DAY = 24 * 60 * 60 * 1000;
export const MS_IN_HOUR = 60 * 60 * 1000;
export function getPeriodEvents(events, start, end) {
    return events.filter((event) => {
        if (event.startDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.endDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.startDate <= start && event.endDate >= end) {
            return true;
        }
        return false;
    });
}
export function getMonthDayEvents(events, start, end) {
    return events
        .filter((event) => {
        if (event.startDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.endDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.startDate <= start && event.endDate >= end) {
            return true;
        }
        return false;
    })
        .map((event) => {
        return Object.assign(Object.assign({}, event), { startStr: format(event.startDate, 'YYYY-MM-DDTHH:mm:ss'), endStr: format(event.endDate, 'YYYY-MM-DDTHH:mm:ss'), eventStart: event.startDate >= start, eventEnd: event.endDate <= end, longEvent: event.endDate.getTime() - event.startDate.getTime() >= MS_IN_DAY });
    });
}
export function getListViewEvents(events, start, end) {
    return events
        .filter((event) => {
        if (event.startDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.endDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.startDate <= start && event.endDate >= end) {
            return true;
        }
        if (event.startDate >= start && event.startDate <= end) {
            return true;
        }
        return false;
    })
        .map((event) => {
        return Object.assign(Object.assign({}, event), { startStr: format(event.startDate, 'YYYY-MM-DDTHH:mm:ss'), endStr: format(event.endDate, 'YYYY-MM-DDTHH:mm:ss'), start: {
                date: format(event.startDate, 'DD/MM/YYYY'),
                time: format(event.startDate, 'h:mm:ss A'),
            }, end: {
                date: format(event.endDate, 'DD/MM/YYYY'),
                time: format(event.endDate, 'h:mm:ss A'),
            } });
    });
}
export function getWeekDayEvents(events, start, end, dayStart, dayEnd) {
    return events
        .filter((event) => {
        if (event.startDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.endDate >= start && event.endDate <= end) {
            return true;
        }
        if (event.startDate <= start && event.endDate >= end) {
            return true;
        }
        return false;
    })
        .map((event) => {
        return Object.assign(Object.assign({}, event), { startStr: format(event.startDate, 'YYYY-MM-DDTHH:mm:ss'), endStr: format(event.endDate, 'YYYY-MM-DDTHH:mm:ss'), allDay: event.startDate <= dayStart && event.endDate.getTime() >= dayEnd.getTime() - 999 });
    });
}
export function getWeekHourEvents(events, start, end, dayStart, dayEnd) {
    return getWeekDayEvents(events, start, end, dayStart, dayEnd)
        .filter((event) => !event.allDay)
        .map((event) => {
        return Object.assign(Object.assign({}, event), { eventStart: event.startDate >= start, eventEnd: event.endDate <= end, longEvent: event.endDate.getTime() - event.startDate.getTime() >= MS_IN_HOUR });
    });
}
export function getWeekAllDayEvents(events, start, end, dayStart, dayEnd) {
    return getWeekDayEvents(events, start, end, dayStart, dayEnd)
        .filter((event) => event.allDay)
        .map((event) => {
        return Object.assign(Object.assign({}, event), { eventStart: event.startDate >= dayStart, eventEnd: event.endDate <= dayEnd, longEvent: event.endDate.getTime() - event.startDate.getTime() >= MS_IN_DAY });
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnQtdXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9tZGItY2FsZW5kYXIvc3JjL2xpYi91dGlscy9ldmVudC11dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRWxDLE1BQU0sQ0FBQyxNQUFNLFNBQVMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUM7QUFDN0MsTUFBTSxDQUFDLE1BQU0sVUFBVSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDO0FBRXpDLE1BQU0sVUFBVSxlQUFlLENBQUMsTUFBVyxFQUFFLEtBQVcsRUFBRSxHQUFTO0lBQ2pFLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQVUsRUFBRSxFQUFFO1FBQ2xDLElBQUksS0FBSyxDQUFDLFNBQVMsSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxHQUFHLEVBQUU7WUFDcEQsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxHQUFHLEVBQUU7WUFDbEQsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELElBQUksS0FBSyxDQUFDLFNBQVMsSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxHQUFHLEVBQUU7WUFDcEQsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsTUFBTSxVQUFVLGlCQUFpQixDQUFDLE1BQVcsRUFBRSxLQUFXLEVBQUUsR0FBUztJQUNuRSxPQUFPLE1BQU07U0FDVixNQUFNLENBQUMsQ0FBQyxLQUFVLEVBQUUsRUFBRTtRQUNyQixJQUFJLEtBQUssQ0FBQyxTQUFTLElB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RSxLQUFLLENBQUMsU0FBUyxJQUFJLEtBQUssRUFDcEMsUUFBUSxFQUFFLEtBQUssQ0FBQyxPQUFPLElBQUksR0FBRyxFQUM5QixTQUFTLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxJQUFJLFVBQVUsSUFDNUU7SUFDSixDQUFDLENBQUMsQ0FBQztBQUNQLENBQUM7QUFFRCxNQUFNLFVBQVUsbUJBQW1CLENBQ2pDLE1BQVcsRUFDWCxLQUFXLEVBQ1gsR0FBUyxFQUNULFFBQWMsRUFDZCxNQUFZO0lBRVosT0FBTyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDO1NBQzFELE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztTQUMvQixHQUFHLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtRQUNiLHVDQUNLLEtBQUssS0FDUixVQUFVLEVBQUUsS0FBSyxDQUFDLFNBQVMsSUFBSSxRQUFRLEVBQ3ZDLFFBQVEsRUFBRSxLQUFLLENBQUMsT0FBTyxJQUFJLE1BQU0sRUFDakMsU0FBUyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsSUFBSSxTQUFTLElBQzNFO0lBQ0osQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZm9ybWF0IH0gZnJvbSAnZGF0ZS1mbnMnO1xuXG5leHBvcnQgY29uc3QgTVNfSU5fREFZID0gMjQgKiA2MCAqIDYwICogMTAwMDtcbmV4cG9ydCBjb25zdCBNU19JTl9IT1VSID0gNjAgKiA2MCAqIDEwMDA7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQZXJpb2RFdmVudHMoZXZlbnRzOiBhbnksIHN0YXJ0OiBEYXRlLCBlbmQ6IERhdGUpIHtcbiAgcmV0dXJuIGV2ZW50cy5maWx0ZXIoKGV2ZW50OiBhbnkpID0+IHtcbiAgICBpZiAoZXZlbnQuc3RhcnREYXRlID49IHN0YXJ0ICYmIGV2ZW50LmVuZERhdGUgPD0gZW5kKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQuZW5kRGF0ZSA+PSBzdGFydCAmJiBldmVudC5lbmREYXRlIDw9IGVuZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LnN0YXJ0RGF0ZSA8PSBzdGFydCAmJiBldmVudC5lbmREYXRlID49IGVuZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnRoRGF5RXZlbnRzKGV2ZW50czogYW55LCBzdGFydDogRGF0ZSwgZW5kOiBEYXRlKSB7XG4gIHJldHVybiBldmVudHNcbiAgICAuZmlsdGVyKChldmVudDogYW55KSA9PiB7XG4gICAgICBpZiAoZXZlbnQuc3RhcnREYXRlID49IHN0YXJ0ICYmIGV2ZW50LmVuZERhdGUgPD0gZW5kKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnQuZW5kRGF0ZSA+PSBzdGFydCAmJiBldmVudC5lbmREYXRlIDw9IGVuZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGV2ZW50LnN0YXJ0RGF0ZSA8PSBzdGFydCAmJiBldmVudC5lbmREYXRlID49IGVuZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pXG4gICAgLm1hcCgoZXZlbnQpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmV2ZW50LFxuICAgICAgICBzdGFydFN0cjogZm9ybWF0KGV2ZW50LnN0YXJ0RGF0ZSwgJ1lZWVktTU0tRERUSEg6bW06c3MnKSxcbiAgICAgICAgZW5kU3RyOiBmb3JtYXQoZXZlbnQuZW5kRGF0ZSwgJ1lZWVktTU0tRERUSEg6bW06c3MnKSxcbiAgICAgICAgZXZlbnRTdGFydDogZXZlbnQuc3RhcnREYXRlID49IHN0YXJ0LFxuICAgICAgICBldmVudEVuZDogZXZlbnQuZW5kRGF0ZSA8PSBlbmQsXG4gICAgICAgIGxvbmdFdmVudDogZXZlbnQuZW5kRGF0ZS5nZXRUaW1lKCkgLSBldmVudC5zdGFydERhdGUuZ2V0VGltZSgpID49IE1TX0lOX0RBWSxcbiAgICAgIH07XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaXN0Vmlld0V2ZW50cyhldmVudHM6IGFueSwgc3RhcnQ6IERhdGUsIGVuZDogRGF0ZSkge1xuICByZXR1cm4gZXZlbnRzXG4gICAgLmZpbHRlcigoZXZlbnQ6IGFueSkgPT4ge1xuICAgICAgaWYgKGV2ZW50LnN0YXJ0RGF0ZSA+PSBzdGFydCAmJiBldmVudC5lbmREYXRlIDw9IGVuZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGV2ZW50LmVuZERhdGUgPj0gc3RhcnQgJiYgZXZlbnQuZW5kRGF0ZSA8PSBlbmQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChldmVudC5zdGFydERhdGUgPD0gc3RhcnQgJiYgZXZlbnQuZW5kRGF0ZSA+PSBlbmQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChldmVudC5zdGFydERhdGUgPj0gc3RhcnQgJiYgZXZlbnQuc3RhcnREYXRlIDw9IGVuZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pXG4gICAgLm1hcCgoZXZlbnQpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmV2ZW50LFxuICAgICAgICBzdGFydFN0cjogZm9ybWF0KGV2ZW50LnN0YXJ0RGF0ZSwgJ1lZWVktTU0tRERUSEg6bW06c3MnKSxcbiAgICAgICAgZW5kU3RyOiBmb3JtYXQoZXZlbnQuZW5kRGF0ZSwgJ1lZWVktTU0tRERUSEg6bW06c3MnKSxcbiAgICAgICAgc3RhcnQ6IHtcbiAgICAgICAgICBkYXRlOiBmb3JtYXQoZXZlbnQuc3RhcnREYXRlLCAnREQvTU0vWVlZWScpLFxuICAgICAgICAgIHRpbWU6IGZvcm1hdChldmVudC5zdGFydERhdGUsICdoOm1tOnNzIEEnKSxcbiAgICAgICAgfSxcbiAgICAgICAgZW5kOiB7XG4gICAgICAgICAgZGF0ZTogZm9ybWF0KGV2ZW50LmVuZERhdGUsICdERC9NTS9ZWVlZJyksXG4gICAgICAgICAgdGltZTogZm9ybWF0KGV2ZW50LmVuZERhdGUsICdoOm1tOnNzIEEnKSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWVrRGF5RXZlbnRzKFxuICBldmVudHM6IGFueSxcbiAgc3RhcnQ6IERhdGUsXG4gIGVuZDogRGF0ZSxcbiAgZGF5U3RhcnQ6IERhdGUsXG4gIGRheUVuZDogRGF0ZVxuKSB7XG4gIHJldHVybiBldmVudHNcbiAgICAuZmlsdGVyKChldmVudDogYW55KSA9PiB7XG4gICAgICBpZiAoZXZlbnQuc3RhcnREYXRlID49IHN0YXJ0ICYmIGV2ZW50LmVuZERhdGUgPD0gZW5kKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnQuZW5kRGF0ZSA+PSBzdGFydCAmJiBldmVudC5lbmREYXRlIDw9IGVuZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGV2ZW50LnN0YXJ0RGF0ZSA8PSBzdGFydCAmJiBldmVudC5lbmREYXRlID49IGVuZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pXG4gICAgLm1hcCgoZXZlbnQpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmV2ZW50LFxuICAgICAgICBzdGFydFN0cjogZm9ybWF0KGV2ZW50LnN0YXJ0RGF0ZSwgJ1lZWVktTU0tRERUSEg6bW06c3MnKSxcbiAgICAgICAgZW5kU3RyOiBmb3JtYXQoZXZlbnQuZW5kRGF0ZSwgJ1lZWVktTU0tRERUSEg6bW06c3MnKSxcbiAgICAgICAgYWxsRGF5OiBldmVudC5zdGFydERhdGUgPD0gZGF5U3RhcnQgJiYgZXZlbnQuZW5kRGF0ZS5nZXRUaW1lKCkgPj0gZGF5RW5kLmdldFRpbWUoKSAtIDk5OSxcbiAgICAgIH07XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWVrSG91ckV2ZW50cyhcbiAgZXZlbnRzOiBhbnksXG4gIHN0YXJ0OiBEYXRlLFxuICBlbmQ6IERhdGUsXG4gIGRheVN0YXJ0OiBEYXRlLFxuICBkYXlFbmQ6IERhdGVcbikge1xuICByZXR1cm4gZ2V0V2Vla0RheUV2ZW50cyhldmVudHMsIHN0YXJ0LCBlbmQsIGRheVN0YXJ0LCBkYXlFbmQpXG4gICAgLmZpbHRlcigoZXZlbnQpID0+ICFldmVudC5hbGxEYXkpXG4gICAgLm1hcCgoZXZlbnQpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmV2ZW50LFxuICAgICAgICBldmVudFN0YXJ0OiBldmVudC5zdGFydERhdGUgPj0gc3RhcnQsXG4gICAgICAgIGV2ZW50RW5kOiBldmVudC5lbmREYXRlIDw9IGVuZCxcbiAgICAgICAgbG9uZ0V2ZW50OiBldmVudC5lbmREYXRlLmdldFRpbWUoKSAtIGV2ZW50LnN0YXJ0RGF0ZS5nZXRUaW1lKCkgPj0gTVNfSU5fSE9VUixcbiAgICAgIH07XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWVrQWxsRGF5RXZlbnRzKFxuICBldmVudHM6IGFueSxcbiAgc3RhcnQ6IERhdGUsXG4gIGVuZDogRGF0ZSxcbiAgZGF5U3RhcnQ6IERhdGUsXG4gIGRheUVuZDogRGF0ZVxuKSB7XG4gIHJldHVybiBnZXRXZWVrRGF5RXZlbnRzKGV2ZW50cywgc3RhcnQsIGVuZCwgZGF5U3RhcnQsIGRheUVuZClcbiAgICAuZmlsdGVyKChldmVudCkgPT4gZXZlbnQuYWxsRGF5KVxuICAgIC5tYXAoKGV2ZW50KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5ldmVudCxcbiAgICAgICAgZXZlbnRTdGFydDogZXZlbnQuc3RhcnREYXRlID49IGRheVN0YXJ0LFxuICAgICAgICBldmVudEVuZDogZXZlbnQuZW5kRGF0ZSA8PSBkYXlFbmQsXG4gICAgICAgIGxvbmdFdmVudDogZXZlbnQuZW5kRGF0ZS5nZXRUaW1lKCkgLSBldmVudC5zdGFydERhdGUuZ2V0VGltZSgpID49IE1TX0lOX0RBWSxcbiAgICAgIH07XG4gICAgfSk7XG59XG4iXX0=